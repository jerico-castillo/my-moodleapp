<ion-content delegate-handle="mmaModWikiIndexScroll" padding="true" mm-state-class>
    <ion-refresher pulling-text="{{ 'mm.core.pulltorefresh' | translate }}" ng-if="wikiLoaded" on-refresh="refreshWiki()"></ion-refresher>
    <mm-loading hide-until="wikiLoaded">
        <mm-course-mod-description description="description" watch="true" ng-if="mainpage" component="{{component}}" component-id="{{componentId}}"></mm-course-mod-description>

        <!-- Wiki has something offline. -->
        <section class="card padding" ng-if="isOffline || wikiHasOffline">
            <p class="padding" ng-if="isOffline">{{ 'mm.core.hasdatatosync' | translate:{$a: pageStr} }}</p>
            <p class="padding" ng-if="!isOffline && wikiHasOffline">{{ 'mm.core.hasdatatosync' | translate:{$a: moduleName} }}</p>
            <button class="button button-block icon-right ion-loop" ng-click="sync()">{{ 'mm.settings.synchronizenow' | translate }}</button>
        </section>

        <!-- Page warning. -->
        <div class="padding" ng-if="pageWarning">
            <p class="badge badge-inline badge-assertive padding">
                <i class="icon ion-alert-circled padding"></i> {{ pageWarning }}
            </p>
        </div>

        <article ng-class="{'mma-mod_wiki-noedit': !canEdit}">
            <mm-format-text class="mm-content-with-float" watch="true" component="{{component}}" component-id="{{componentId}}" ng-if="pageContent">{{ pageContent }}</mm-format-text>
            <p ng-if="!pageContent">{{ 'mma.mod_wiki.nocontent' | translate }}</p>
        </article>
    </mm-loading>
</ion-content>