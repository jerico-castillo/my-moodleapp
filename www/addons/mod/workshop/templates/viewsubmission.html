<ion-view>
    <ion-nav-title><mm-format-text watch="true">{{ title }}</mm-format-text></ion-nav-title>
    <ion-content mm-state-class delegate-handle="mmaModWorkshopSubmissionScroll">
        <ion-refresher pulling-text="{{ 'mm.core.pulltorefresh' | translate }}" ng-if="submissionLoaded" on-refresh="refreshSubmission()"></ion-refresher>
        <mm-loading hide-until="submissionLoaded">
            <div class="list" ng-if="submission">
                <mma-mod-workshop-submission submission="submission" courseid="courseId" module="module">
                </mma-mod-workshop-submission>
                <div ng-if="canEdit || canDelete" class="item item-text-wrap">
                    <a class="button button-block button-positive icon-left ion-edit" ng-if="canEdit" ng-click="editSubmission()">{{ 'mma.mod_workshop.editsubmission' | translate }}</a>
                    <a ng-if="!submission.deleted && canDelete" class="button button-block button-assertive icon-left ion-trash-a" ng-click="deleteSubmission()">{{ 'mma.mod_workshop.deletesubmission' | translate }}</a>
                    <a ng-if="submission.deleted && canDelete" class="button button-block icon-left ion-reply" ng-click="undoDeleteSubmission()">{{ 'mm.core.restore' | translate }}</a>
                </div>
            </div>

            <div class="list" ng-if="ownAssessment && !assessment">
                <div class="item item-text-wrap">
                    <h2>{{ 'mma.mod_workshop.yourassessment' | translate }}</h2>
                </div>
                <mma-mod-workshop-assessment submission="submission" assessment="ownAssessment" courseid="courseId" summary="true" maxgrade="maxGrade" access="access" module="module" workshop="workshop"></mma-mod-workshop-assessment>
            </div>

            <div class="list" ng-if="submissionInfo.reviewedby.length && !assessment">
                <div class="item item-text-wrap">
                    <h2>{{ 'mma.mod_workshop.receivedgrades' | translate }}</h2>
                </div>
                <mma-mod-workshop-assessment ng-repeat="reviewer in submissionInfo.reviewedby" ng-if="!reviewer.ownAssessment" submission="submission" assessment="reviewer" courseid="courseId" summary="true" maxgrade="maxGrade" access="access"></mma-mod-workshop-assessment>
            </div>

            <div class="list" ng-if="submissionInfo.reviewerof.length && !assessment">
                <div class="item item-text-wrap">
                    <h2>{{ 'mma.mod_workshop.givengrades' | translate }}</h2>
                </div>
                <mma-mod-workshop-assessment ng-repeat="reviewer in submissionInfo.reviewerof" assessment="reviewer" courseid="courseId" summary="true" maxgrade="maxGrade"></mma-mod-workshop-assessment>
            </div>

            <mma-mod-workshop-assessment-strategy ng-if="assessment" workshop="workshop" access="access" assessment="assessment" strategy="strategy" edit="true"></mma-mod-workshop-assessment-strategy>
        </mm-loading>
    </ion-content>
</ion-view>
