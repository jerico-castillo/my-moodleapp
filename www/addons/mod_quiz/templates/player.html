<ion-view>
    <ion-nav-title><mm-format-text watch="true">{{ quiz.name }}</mm-format-text></ion-nav-title>
    <ion-nav-buttons side="secondary">
        <button class="button button-icon ion-more" ng-if="toc && toc.length" ng-click="popover.show($event)">
        </button>
    </ion-nav-buttons>
    <ion-content mm-state-class>
        <mm-loading hide-until="dataLoaded">
            <div class="list" ng-if="!attempt">
                <button class="button button-block" ng-click="start()">{{ 'mma.mod_quiz.startattempt' | translate }}</button>
            </div>
            <!-- Questions -->
            <div ng-if="attempt && questions.length && !quizAborted">
                <mma-mod-quiz-arrows previous="previousPage" next="nextPage" action="loadPage"></mma-mod-quiz-arrows>
                <div ng-repeat="question in questions">
                    <section class="card">
                        <div class="item item-divider">
                            <h2 ng-if="question.number">{{ 'mma.mod_quiz.questionno' | translate:{$a: question.number} }}</h2>
                            <h2 ng-if="!question.number">{{ 'mma.mod_quiz.information' | translate }}</h2>
                        </div>
                        <div class="item item-text-wrap" ng-if="question.status">
                            <p>{{question.status}}</p>
                        </div>
                        <div class="item item-text-wrap" ng-if="question.readableMark">
                            <p>{{question.readableMark}}</p>
                        </div>
                        <ion-checkbox ng-model="question.flagged">{{ 'mma.mod_quiz.flagged' | translate }}</ion-checkbox>
                        <mm-question class="item item-complex" question="question" answers="answers" abort="abortQuiz()"></mm-question>
                    </section>
                </div>
                <mma-mod-quiz-arrows previous="previousPage" next="nextPage" action="loadPage"></mma-mod-quiz-arrows>
            </div>
            <!-- Quiz aborted -->
            <section class="card" ng-if="attempt && (!questions.length || quizAborted)">
                <div class="item item-text-wrap">
                    <p>{{ 'mma.mod_quiz.errorparsequestions' | translate }}</p>
                </div>
                <div class="item">
                    <a class="button button-block" ng-href="{{moduleUrl}}" mm-browser>{{ 'mm.core.openinbrowser' | translate }}</a>
                </div>
            </section>
        </mm-loading>
    </ion-content>
</ion-view>