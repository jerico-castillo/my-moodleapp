<ion-view view-title="{{ 'mma.pushnotifications.notificationpreferences' | translate }}">
    <mm-nav-buttons side="secondary">
        <mm-context-menu merge="true">
            <mm-context-menu-item ng-repeat="processor in preferences.processors" priority="700" ng-show="processor.name != currentProcessor.name" content="processor.displayname" action="changeProcessor(processor)" icon-action="'ion-gear-b'"></mm-context-menu-item>
            <mm-context-menu-item ng-show="currentProcessor && currentProcessor.hassettings && currentProcessor.supported" priority="600" content="'mma.pushnotifications.processorsettings' | translate" action="openProcessorPreferences()" icon-action="'ion-gear-b'"></mm-context-menu-item>
        </mm-context-menu>
    </mm-nav-buttons>
    <ion-content mm-state-class delegate-handle="mmaPushNotificationsNotificationPreferencesScroll">
        <ion-refresher pulling-text="{{ 'mm.core.pulltorefresh' | translate }}" ng-if="preferencesLoaded" on-refresh="refreshPreferences()">
        </ion-refresher>
        <mm-loading hide-until="preferencesLoaded">
            <div class="card">
                <ion-toggle class="item-text-wrap" ng-model="preferences.disableall">
                    {{ 'mma.pushnotifications.disableall' | translate }}
                </ion-toggle>
            </div>

            <div class="card">
                <p class="item item-icon-left item-howto item-text-wrap" ng-class="{'item-icon-right': currentProcessor.hassettings && currentProcessor.supported}" ng-click="openProcessorPreferences()">
                    <i class="icon ion-information"></i>
                    {{ 'mma.pushnotifications.configuringnotifications' | translate:{$a: currentProcessor.displayname} }}
                    <i ng-if="currentProcessor.hassettings && currentProcessor.supported" class="icon ion-gear-b"></i>
                </p>
            </div>

            <!-- Tablet view -->
            <ul ng-if="isTablet" class="list card" ng-repeat="component in components">
                <li class="item item-divider item-text-wrap row">
                    <div class="col col-60">{{ component.displayname }}</div>
                    <p class="col col-20 text-center">{{ 'mma.pushnotifications.loggedin' | translate }}</p>
                    <p class="col col-20 text-center">{{ 'mma.pushnotifications.loggedoff' | translate }}</p>
                </li>
                <li class="item item-text-wrap item-toggle-relative row" ng-repeat="notification in component.notifications">
                    <div class="col col-60">{{ notification.displayname }}</div>
                    <div class="col col-20 text-center">
                        <ion-toggle ng-if="!preferences.disableall" ng-model="notification.currentProcessor.loggedin.checked"></ion-toggle>
                        <span ng-if="preferences.disableall">{{ 'mma.pushnotifications.disabled' | translate }}</span>
                    </div>
                    <div class="col col-20 text-center">
                        <ion-toggle ng-if="!preferences.disableall" ng-model="notification.currentProcessor.loggedoff.checked"></ion-toggle>
                        <span ng-if="preferences.disableall">{{ 'mma.pushnotifications.disabled' | translate }}</span>
                    </div>
                </li>
            </ul>

            <!-- Phone view -->
            <ul ng-if="!isTablet" class="list card" ng-repeat="component in components">
                <li class="item item-divider item-text-wrap">{{ component.displayname }}</li>
                <div class="item item-text-wrap" ng-repeat="notification in component.notifications">
                    {{ notification.displayname }}
                    <ion-toggle ng-if="!preferences.disableall" class="item-text-wrap" ng-model="notification.currentProcessor.loggedin.checked">
                        <small>{{ 'mma.pushnotifications.loggedin' | translate }}</small>
                    </ion-toggle>
                    <ion-toggle ng-if="!preferences.disableall" class="item-text-wrap item-no-border-top item-no-padding-bottom" ng-model="notification.currentProcessor.loggedoff.checked">
                        <small>{{ 'mma.pushnotifications.loggedoff' | translate }}</small>
                    </ion-toggle>
                    <div class="item item-text-wrap" ng-if="preferences.disableall">
                        <small>{{ 'mma.pushnotifications.loggedin' | translate }}</small>
                        <span class="item-note">{{ 'mma.pushnotifications.disabled' | translate }}</span>
                    </div>
                    <div class="item item-text-wrap item-no-border-top item-no-padding-bottom" ng-if="preferences.disableall">
                        <small>{{ 'mma.pushnotifications.loggedoff' | translate }}</small>
                        <span class="item-note">{{ 'mma.pushnotifications.disabled' | translate }}</span>
                    </div>
                </div>
            </ul>
        </mm-loading>
    </ion-content>
</ion-view>